# 代码与excel，生成xlsx

Excel是微软的Office套装中的电子表格软件，大家经常用到它。微软的财报显示，Office的营收一直在微软的整个营收中占了不少的比例。说明至今还有许多用户在使用微软Office，也说明了它在提升创造力和工作效率方面是一把好手。

Excel 2007以后的版本，它的文件格式为".xlsx"，Excel 2007之前的版本，它的文件格式为“.xls”。文件格式是什么呢？文件在存储之前，需要对文件的数据进行编码，这个编码的方式就叫文件格式。这听起来听抽象的，但生活中跟编码的例子有很多。比如电影票上面印的“几行几座”，这就是电影院对座位的编码方式。同样是座位，飞机上的，动车上的和电影院的座位编码方式是不一样的。同样，你可以把文件中的数据想象去看电影的人，把它们存放磁盘的时候，不能随意乱放，得给它们编号，按一定的规则放一起。否则就乱套了。

Excel 2007以后的“.xlsx”是一种开放的数据格式。因为是开放的格式，意味着不用excel也能读写xlsx中的数据。这一特点让代码读写xlsx变得非常地方便。下面我们用代码来体验一下。



### 新建excel文件

---



```py
# -*- coding: UTF-8 -*-
from openpyxl import  Workbook
workbook = Workbook()
sheet1 = workbook.active
sheet1.cell(1, 1, '这是一个单元格')
workbook.save('新建 XLSX 工作表.xlsx')
```

*([源代码](example-xlsx-1.py))*

运行完这段代码后，在代码所在文件目录中，将会看到“新建 XLSX 工作表.xlsx”文件，然后用Excel打开它，它有一个工作表(sheet)，单元格A1的值为“这是一个单元格”。*(Excel2007，WPS，LibreOffice都可能打开.xlsx文件)*



下面我们来阅读并分析一下代码。

```python
# -*- coding: UTF-8 -*-
```

声明文件所使用的编码为UTF-8。因历史原因，早期电脑的文件编码只能处理英文字符，不能处理汉字，日文，韩文，阿拉伯语等非英文字符。后来出现了UTF-8编码方式，它的出现解决了这一问题。

默认情况下，Python 源码文件以 UTF-8 编码方式处理。如果因为其它原因导致出现了中文乱码，则可以在文件的头部加上这条声明。



```pyt
from openpyxl import  Workbook
```

**从**openpyxl这个包中**引用**workbook这个模块。如果需要从**包**中引用**模块**，就使用“from 包 import 模块”这个句型。其中from和import是**关键字**。

包，模块，引用这三个是什么鬼？关键字又是什么鬼？前者是代码的组织方式，后者是编程的行话。

模块是一个包含Python定义和语句的文件，文件的后缀为“.py”。将上面的6行代码保存成一个.py文件，那这个文件就称之为一个模块。模块文件是存放在文件夹中的，当模块数量多了之后怎么办呢？用文件夹将它们分门别类存储起来。如果在文件夹下放一个“\__init__.py”文件，那这个文件夹就称之为包。

我们之所以能很方便地访问xlsx文件，那是因为有人写了一系列操作xlsx的模块，比如Workbook是其中的一个模块，这些模块放在openpyxl包中。

当我们写出from openpyxl import  Workbook这样的行话，Python就会从openpyxl包中引入Workbook模块。

*（openpyxl不是python自带的包，需要自行安装，具体方法参考附录）*

```python
workbook = Workbook()
```

workbook是一个变量，变量来源于数学。比如y是一个变量，y = 1，把1赋值给y，y代表了1。也可以 y = 2x+3，把2x+3赋给y，y代表2x+3。还可以 y = '你好'。y 可不可以取别的名字呢？完全可以，命名变量的目的是为了增强代码的可读性，因此给变量取的名字要一目了然。

Workbook是一个类，Workbook()表示根据Workbook类创建一个对象。把用类创建对象的过程称为实例化。等号将新建的对象赋给变量workbook。



**类**，**对象**，**实例化**又是什么鬼呢？

如果说**类**是制造汽车的设计图纸，那么**对象**是就是按照设计图纸造出来的车，**实例化**就是按图纸造出一辆车。车的颜色，价格，最大车速这些叫**属性**，车的启动，刹车，打方向这些功能叫**方法**。编程有很多种风格，如同唱歌有很多的风格是一样的。这种类，对象，实例化的风格就叫“面向对象编程”。

如果感觉这些概念还是那么抽象，不容易理解，不要紧。我们继续阅读代码，多读代码，其义自见。

workbook = Workbook()，即实例化Workbook对象，将对象赋给workbook这个变量。也就是说，workbook就是一个Workbook对象。Workbook对象具备Excel的一部分功能。



```python
sheet1 = workbook.active
```

workbook.active，“.”后的active是workbook这个对象的属性。它相当于大家打开excel后，选中第一个工作表sheet这个操作。选中excel中的第一个sheet，并将它赋值给变量sheet1。



```python
sheet1.cell(1, 1, '这是一个单元格')
```

cell是工作表中一个函数，它有操作单元格的功能。比如，cell(1, 1, '这是一个单元格')的意思是在第一行第一列的单元格中写入“这是一个单元格”。



```python
workbook.save('新建 XLSX 工作表.xlsx')
```

使用workbook对象中的save函数保存excel文件，文件名为“新建 XLSX 工作表.xlsx”。



从阅读上面的代码，大家会发现这样的一种感觉，写代码像是在交代某人做某事，先做什么，后做什么，在什么地方该做什么。没错！可以把编程理解为交代电脑做某事。



## 附录

1、如何查看Python所有的关键字

```pyt
import keyword
print(keyword.kwlist)
```

关键字就是程序语言保留的词。比如from import这些词就是python保留的词。给变量取名字不能使用这些关键字同名，否则会报错。



2、安装第三方的包

Python之所以功能强大，除了python自带的功能包以外，还有第三方提供了大量的包。这好比手机之所有功能强大，除了系统自带的APP，还有第三方开发商提供了大量的APP。每一个手机都有一个应用商店，那python也有一个类似的应用商店。它叫pypi。官网网址[https://pypi.org/](https://pypi.org/)

如果你知道了包的名字，通常可以用以下的命令进行安装。在命令行里输入

```shell
pip install 名称
```

比如，安装openpyxl的命令如下：

```shell
pip install openpyxl
```

当然也有例外的情况，一切以官网文档为准。